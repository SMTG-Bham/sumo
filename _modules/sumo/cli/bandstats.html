<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sumo.cli.bandstats &#8212; sumo 2.3.10 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=7a828971"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for sumo.cli.bandstats</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) Scanlon Materials Theory Group</span>
<span class="c1"># Distributed under the terms of the MIT License.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A script to calculate effective masses and band degeneracies.</span>

<span class="sd">TODO:</span>
<span class="sd"> - Would be good to reimplement get_vbm and get_cbm methods, with the ability</span>
<span class="sd">   to give degeneracies + other band edges within a certain tolerance.</span>
<span class="sd"> - Sample custom k-point, band, spin combinations.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">pymatgen.electronic_structure.core</span> <span class="kn">import</span> <span class="n">Spin</span>
<span class="kn">from</span> <span class="nn">pymatgen.io.vasp.outputs</span> <span class="kn">import</span> <span class="n">BSVasprun</span>

<span class="kn">from</span> <span class="nn">sumo.cli.bandplot</span> <span class="kn">import</span> <span class="n">find_vasprun_files</span>
<span class="kn">from</span> <span class="nn">sumo.electronic_structure.bandstructure</span> <span class="kn">import</span> <span class="n">get_reconstructed_band_structure</span>
<span class="kn">from</span> <span class="nn">sumo.electronic_structure.effective_mass</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">fit_effective_mass</span><span class="p">,</span>
    <span class="n">get_fitting_data</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Alex Ganose&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Alex Ganose&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;alexganose@googlemail.com&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;March 4, 2018&quot;</span>


<span class="n">kpt_str</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">{k[0]:.2f}</span><span class="s2">, </span><span class="si">{k[1]:.2f}</span><span class="s2">, </span><span class="si">{k[2]:.2f}</span><span class="s2">]&quot;</span>


<div class="viewcode-block" id="bandstats">
<a class="viewcode-back" href="../../../sumo.cli.html#sumo.cli.bandstats.bandstats">[docs]</a>
<span class="k">def</span> <span class="nf">bandstats</span><span class="p">(</span>
    <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">num_sample_points</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">degeneracy_tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
    <span class="n">parabolic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the effective masses of the bands of a semiconductor.</span>

<span class="sd">    Args:</span>
<span class="sd">        filenames (:obj:`str` or :obj:`list`, optional): Path to vasprun.xml</span>
<span class="sd">            or vasprun.xml.gz file. If no filenames are provided, the code</span>
<span class="sd">            will search for vasprun.xml or vasprun.xml.gz files in folders</span>
<span class="sd">            named &#39;split-0*&#39;. Failing that, the code will look for a vasprun in</span>
<span class="sd">            the current directory. If a :obj:`list` of vasprun files is</span>
<span class="sd">            provided, these will be combined into a single band structure.</span>
<span class="sd">        num_sample_points (:obj:`int`, optional): Number of k-points to sample</span>
<span class="sd">            when fitting the effective masses.</span>
<span class="sd">        temperature (:obj:`int`, optional): Find band edges within kB * T of</span>
<span class="sd">            the valence band maximum and conduction band minimum. Not currently</span>
<span class="sd">            implemented.</span>
<span class="sd">        degeneracy_tol (:obj:`float`, optional): Tolerance for determining the</span>
<span class="sd">            degeneracy of the valence band maximum and conduction band minimum.</span>
<span class="sd">        parabolic (:obj:`bool`, optional): Use a parabolic fit of the band</span>
<span class="sd">            edges. If ``False`` then nonparabolic fitting will be attempted.</span>
<span class="sd">            Defaults to ``True``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The hole and electron effective masses. Formatted as a</span>
<span class="sd">        :obj:`dict` with keys: ``&#39;hole_data&#39;`` and ``&#39;electron_data&#39;``. The</span>
<span class="sd">        data is a :obj:`list` of :obj:`dict` with the keys:</span>

<span class="sd">        &#39;effective_mass&#39; (:obj:`float`)</span>
<span class="sd">            The effective mass in units of electron rest mass, :math:`m_0`.</span>

<span class="sd">        &#39;energies&#39; (:obj:`numpy.ndarray`)</span>
<span class="sd">            Band eigenvalues in eV.</span>

<span class="sd">        &#39;distances&#39; (:obj:`numpy.ndarray`)</span>
<span class="sd">            Distances of the k-points in reciprocal space.</span>

<span class="sd">        &#39;band_id&#39; (:obj:`int`)</span>
<span class="sd">            The index of the band,</span>

<span class="sd">        &#39;spin&#39; (:obj:`~pymatgen.electronic_structure.core.Spin`)</span>
<span class="sd">            The spin channel</span>

<span class="sd">        &#39;start_kpoint&#39; (:obj:`int`)</span>
<span class="sd">            The index of the k-point at which the band extrema occurs</span>

<span class="sd">        &#39;end_kpoint&#39; (:obj:`int`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="n">find_vasprun_files</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">filenames</span><span class="p">]</span>

    <span class="n">bandstructures</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vr_file</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">vr</span> <span class="o">=</span> <span class="n">BSVasprun</span><span class="p">(</span><span class="n">vr_file</span><span class="p">,</span> <span class="n">parse_projected_eigen</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">bs</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">get_band_structure</span><span class="p">(</span><span class="n">line_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">efermi</span><span class="o">=</span><span class="s2">&quot;smart&quot;</span><span class="p">)</span>
        <span class="n">bandstructures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
    <span class="n">bs</span><span class="p">,</span> <span class="n">kpt_mapping</span> <span class="o">=</span> <span class="n">get_reconstructed_band_structure</span><span class="p">(</span>
        <span class="n">bandstructures</span><span class="p">,</span> <span class="n">force_kpath_branches</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_forced_branch_kpt_map</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">bs</span><span class="o">.</span><span class="n">is_metal</span><span class="p">():</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ERROR: System is metallic!&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="n">_log_band_gap_information</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="o">=</span><span class="n">kpt_mapping</span><span class="p">)</span>

    <span class="n">vbm_data</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_vbm</span><span class="p">()</span>
    <span class="n">cbm_data</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_cbm</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valence band maximum:&quot;</span><span class="p">)</span>
    <span class="n">_log_band_edge_information</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">vbm_data</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="o">=</span><span class="n">kpt_mapping</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Conduction band minimum:&quot;</span><span class="p">)</span>
    <span class="n">_log_band_edge_information</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">cbm_data</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="o">=</span><span class="n">kpt_mapping</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">parabolic</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Using parabolic fitting of the band edges&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Using nonparabolic fitting of the band edges&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">temperature</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ERROR: This feature is not yet supported!&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Work out where the hole and electron band edges are.</span>
        <span class="c1"># Fortunately, pymatgen does this for us. Points at which to calculate</span>
        <span class="c1"># the effective mass are identified as a tuple of:</span>
        <span class="c1"># (spin, band_index, kpoint_index)</span>
        <span class="n">hole_extrema</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">spin</span><span class="p">,</span> <span class="n">bands</span> <span class="ow">in</span> <span class="n">vbm_data</span><span class="p">[</span><span class="s2">&quot;band_index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">hole_extrema</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">kpoint</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span>
                    <span class="k">for</span> <span class="n">kpoint</span> <span class="ow">in</span> <span class="n">vbm_data</span><span class="p">[</span><span class="s2">&quot;kpoint_index&quot;</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="n">elec_extrema</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">spin</span><span class="p">,</span> <span class="n">bands</span> <span class="ow">in</span> <span class="n">cbm_data</span><span class="p">[</span><span class="s2">&quot;band_index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">elec_extrema</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="n">spin</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">kpoint</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span>
                    <span class="k">for</span> <span class="n">kpoint</span> <span class="ow">in</span> <span class="n">cbm_data</span><span class="p">[</span><span class="s2">&quot;kpoint_index&quot;</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="c1"># extract the data we need for fitting from the band structure</span>
        <span class="n">hole_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">extrema</span> <span class="ow">in</span> <span class="n">hole_extrema</span><span class="p">:</span>
            <span class="n">hole_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">get_fitting_data</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="o">*</span><span class="n">extrema</span><span class="p">,</span> <span class="n">num_sample_points</span><span class="o">=</span><span class="n">num_sample_points</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">elec_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">extrema</span> <span class="ow">in</span> <span class="n">elec_extrema</span><span class="p">:</span>
            <span class="n">elec_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">get_fitting_data</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="o">*</span><span class="n">extrema</span><span class="p">,</span> <span class="n">num_sample_points</span><span class="o">=</span><span class="n">num_sample_points</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># calculate the effective masses and log the information</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Hole effective masses:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">hole_data</span><span class="p">:</span>
        <span class="n">eff_mass</span> <span class="o">=</span> <span class="n">fit_effective_mass</span><span class="p">(</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;energies&quot;</span><span class="p">],</span> <span class="n">parabolic</span><span class="o">=</span><span class="n">parabolic</span>
        <span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;effective_mass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eff_mass</span>
        <span class="n">_log_effective_mass_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bs</span><span class="o">.</span><span class="n">is_spin_polarized</span><span class="p">,</span> <span class="n">mass_type</span><span class="o">=</span><span class="s2">&quot;m_h&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Electron effective masses:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">elec_data</span><span class="p">:</span>
        <span class="n">eff_mass</span> <span class="o">=</span> <span class="n">fit_effective_mass</span><span class="p">(</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;energies&quot;</span><span class="p">],</span> <span class="n">parabolic</span><span class="o">=</span><span class="n">parabolic</span>
        <span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;effective_mass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eff_mass</span>
        <span class="n">_log_effective_mass_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bs</span><span class="o">.</span><span class="n">is_spin_polarized</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hole_data&quot;</span><span class="p">:</span> <span class="n">hole_data</span><span class="p">,</span> <span class="s2">&quot;electron_data&quot;</span><span class="p">:</span> <span class="n">elec_data</span><span class="p">}</span></div>



<span class="k">def</span> <span class="nf">_log_band_gap_information</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log data about the direct and indirect band gaps.</span>

<span class="sd">    Args:</span>
<span class="sd">        bs (:obj:`~pymatgen.electronic_structure.bandstructure.BandStructureSymmLine`):</span>
<span class="sd">        kpt_mapping (:obj:`dict`, optional): A mapping of k-point indicies from the</span>
<span class="sd">            band structure with forced branches to the original band structure.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bg_data</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_band_gap</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bg_data</span><span class="p">[</span><span class="s2">&quot;direct&quot;</span><span class="p">]:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Indirect band gap: </span><span class="si">{</span><span class="n">bg_data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="n">direct_data</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_direct_band_gap_dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">bs</span><span class="o">.</span><span class="n">is_spin_polarized</span><span class="p">:</span>
        <span class="n">direct_bg</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">spin_data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">spin_data</span> <span class="ow">in</span> <span class="n">direct_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Direct band gap: </span><span class="si">{</span><span class="n">direct_bg</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">spin</span><span class="p">,</span> <span class="n">spin_data</span> <span class="ow">in</span> <span class="n">direct_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">direct_kindex</span> <span class="o">=</span> <span class="n">spin_data</span><span class="p">[</span><span class="s2">&quot;kpoint_index&quot;</span><span class="p">]</span>
            <span class="n">direct_kpoint</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">kpoints</span><span class="p">[</span><span class="n">direct_kindex</span><span class="p">]</span><span class="o">.</span><span class="n">frac_coords</span>
            <span class="n">direct_kpoint</span> <span class="o">=</span> <span class="n">kpt_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">direct_kpoint</span><span class="p">)</span>
            <span class="n">eq_kpoints</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_equivalent_kpoints</span><span class="p">(</span><span class="n">direct_kindex</span><span class="p">)</span>
            <span class="n">eq_kpoints</span> <span class="o">=</span> <span class="n">_map_kpoints</span><span class="p">(</span><span class="n">eq_kpoints</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="p">)</span>
            <span class="n">k_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">eq_kpoints</span><span class="p">))</span>

            <span class="c1"># add 1 to band indices to be consistent with VASP band numbers.</span>
            <span class="n">b_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">spin_data</span><span class="p">[</span><span class="s2">&quot;band_indices&quot;</span><span class="p">]])</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">spin</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    k-point: </span><span class="si">{</span><span class="n">direct_kpoint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    k-point indices: </span><span class="si">{</span><span class="n">k_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Band indices: </span><span class="si">{</span><span class="n">b_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">direct_bg</span> <span class="o">=</span> <span class="n">direct_data</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Direct band gap: </span><span class="si">{</span><span class="n">direct_bg</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

        <span class="n">direct_kindex</span> <span class="o">=</span> <span class="n">direct_data</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">][</span><span class="s2">&quot;kpoint_index&quot;</span><span class="p">]</span>
        <span class="n">direct_kpoint</span> <span class="o">=</span> <span class="n">kpt_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">bs</span><span class="o">.</span><span class="n">kpoints</span><span class="p">[</span><span class="n">direct_kindex</span><span class="p">]</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>
        <span class="n">eq_kpoints</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_equivalent_kpoints</span><span class="p">(</span><span class="n">direct_kindex</span><span class="p">)</span>
        <span class="n">eq_kpoints</span> <span class="o">=</span> <span class="n">_map_kpoints</span><span class="p">(</span><span class="n">eq_kpoints</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="p">)</span>
        <span class="n">k_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">eq_kpoints</span><span class="p">))</span>
        <span class="n">b_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">direct_data</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">][</span><span class="s2">&quot;band_indices&quot;</span><span class="p">]]</span>
        <span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k-point: </span><span class="si">{</span><span class="n">direct_kpoint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k-point indices: </span><span class="si">{</span><span class="n">k_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Band indices: </span><span class="si">{</span><span class="n">b_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_log_band_edge_information</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">edge_data</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log data about the valence band maximum or conduction band minimum.</span>

<span class="sd">    Args:</span>
<span class="sd">        bs (:obj:`~pymatgen.electronic_structure.bandstructure.BandStructureSymmLine`):</span>
<span class="sd">            The band structure.</span>
<span class="sd">        edge_data (dict): The :obj:`dict` from ``bs.get_vbm()`` or</span>
<span class="sd">            ``bs.get_cbm()``</span>
<span class="sd">        kpt_mapping (:obj:`dict`, optional): A mapping of k-point indicies from the</span>
<span class="sd">            band structure with forced branches to the original band structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bs</span><span class="o">.</span><span class="n">is_spin_polarized</span><span class="p">:</span>
        <span class="n">spins</span> <span class="o">=</span> <span class="n">edge_data</span><span class="p">[</span><span class="s2">&quot;band_index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">b_indices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">edge_data</span><span class="p">[</span><span class="s2">&quot;band_index&quot;</span><span class="p">][</span><span class="n">spin</span><span class="p">]])</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">spin</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">for</span> <span class="n">spin</span> <span class="ow">in</span> <span class="n">spins</span>
        <span class="p">]</span>
        <span class="n">b_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b_indices</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">b_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">edge_data</span><span class="p">[</span><span class="s2">&quot;band_index&quot;</span><span class="p">][</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">]])</span>

    <span class="n">kpoint</span> <span class="o">=</span> <span class="n">edge_data</span><span class="p">[</span><span class="s2">&quot;kpoint&quot;</span><span class="p">]</span>
    <span class="n">kpoint_str</span> <span class="o">=</span> <span class="n">kpt_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">kpoint</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>
    <span class="n">k_indices</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">_map_kpoints</span><span class="p">(</span><span class="n">edge_data</span><span class="p">[</span><span class="s2">&quot;kpoint_index&quot;</span><span class="p">],</span> <span class="n">kpt_mapping</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">k_degen</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_kpoint_degeneracy</span><span class="p">(</span><span class="n">kpoint</span><span class="o">=</span><span class="n">kpoint</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">kpoint</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
        <span class="n">k_loc</span> <span class="o">=</span> <span class="n">kpoint</span><span class="o">.</span><span class="n">label</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">branch</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">get_branch</span><span class="p">(</span><span class="n">edge_data</span><span class="p">[</span><span class="s2">&quot;kpoint_index&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">k_loc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;between </span><span class="si">{</span><span class="n">branch</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Energy: </span><span class="si">{</span><span class="n">edge_data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k-point: </span><span class="si">{</span><span class="n">kpoint_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k-point location: </span><span class="si">{</span><span class="n">k_loc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k-point indices: </span><span class="si">{</span><span class="n">k_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  k-point degeneracy: </span><span class="si">{</span><span class="n">k_degen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Band indices: </span><span class="si">{</span><span class="n">b_indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_log_effective_mass_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">is_spin_polarized</span><span class="p">,</span> <span class="n">mass_type</span><span class="o">=</span><span class="s2">&quot;m_e&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log data about the effective masses and their directions.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): The effective mass data. Formatted as a :obj:`dict` with</span>
<span class="sd">            the keys:</span>

<span class="sd">            &#39;effective_mass&#39; (:obj:`float`)</span>
<span class="sd">                The effective mass in units of electron rest mass, :math:`m_0`.</span>

<span class="sd">            &#39;energies&#39; (:obj:`numpy.ndarray`)</span>
<span class="sd">                Band eigenvalues in eV.</span>

<span class="sd">            &#39;band_id&#39; (:obj:`int`)</span>
<span class="sd">                The index of the band,</span>

<span class="sd">            &#39;spin&#39; (:obj:`~pymatgen.electronic_structure.core.Spin`)</span>
<span class="sd">                The spin channel</span>

<span class="sd">            &#39;start_kpoint&#39; (:obj:`int`)</span>
<span class="sd">                The index of the k-point at which the band extrema occurs</span>

<span class="sd">            &#39;end_kpoint&#39; (:obj:`int`)</span>
<span class="sd">                The k-point towards which the data has been sampled.</span>

<span class="sd">        is_spin_polarized (bool): Whether the system is spin polarized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">is_spin_polarized</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># add 1 to band id to be consistent with VASP</span>
    <span class="n">band_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;band </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;band_id&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">start_kpoint</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;start_kpoint&quot;</span><span class="p">]</span>
    <span class="n">end_kpoint</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;end_kpoint&quot;</span><span class="p">]</span>
    <span class="n">eff_mass</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;effective_mass&quot;</span><span class="p">]</span>

    <span class="n">kpoint_str</span> <span class="o">=</span> <span class="n">kpt_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">start_kpoint</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start_kpoint</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
        <span class="n">kpoint_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">start_kpoint</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">kpoint_str</span> <span class="o">+=</span> <span class="s2">&quot; -&gt; &quot;</span>
    <span class="n">kpoint_str</span> <span class="o">+=</span> <span class="n">kpt_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">end_kpoint</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end_kpoint</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
        <span class="n">kpoint_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">end_kpoint</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">mass_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">eff_mass</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">band_str</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">kpoint_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_map_kpoints</span><span class="p">(</span><span class="n">kpt_idxs</span><span class="p">,</span> <span class="n">kpt_mapping</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Map k-point indices to the original band structure.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kpt_mapping</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">kpt_idxs</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">kpt_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kpt_idxs</span><span class="p">]))</span>


<span class="k">def</span> <span class="nf">_get_parser</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    bandstats provides information on the band gap and effective</span>
<span class="s2">    masses of semiconductors.&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Author: </span><span class="si">{</span><span class="n">__author__</span><span class="si">}</span>
<span class="s2">    Version: </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span>
<span class="s2">    Last updated: </span><span class="si">{</span><span class="n">__date__</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--filenames&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;one or more vasprun.xml files to plot&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-n&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--nonparabolic&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_false&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;use a nonparabolic model to fit the effective masses&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--sample-points&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;sample_points&quot;</span><span class="p">,</span>
        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;number of k-points to sample in fitting&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">_get_parser</span><span class="p">()</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
        <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;sumo-bandstats.log&quot;</span><span class="p">,</span>
        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
        <span class="n">filemode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">console</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[:]))</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console</span><span class="p">)</span>

    <span class="n">bandstats</span><span class="p">(</span>
        <span class="n">filenames</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">filenames</span><span class="p">,</span>
        <span class="n">num_sample_points</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">sample_points</span><span class="p">,</span>
        <span class="n">parabolic</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">nonparabolic</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">sumo</a></h1>



<p class="blurb">Heavy weight plotting tools</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=SMTG-Bham&repo=sumo&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Python API</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Scanlon Materials Theory Group.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>